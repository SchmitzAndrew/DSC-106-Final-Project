<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=1.0"
    />
    <title>Kernel Density Estimation</title>
    <meta property="og:title" content="Kernel Density Estimation" />
    <meta charset="utf-8" />
    <meta property="og:image" content="https:&#x2F;&#x2F;mathisonian.github.io&#x2F;kde&#x2F;images&#x2F;share.png" />
    <meta name="twitter:image:src" content="https:&#x2F;&#x2F;mathisonian.github.io&#x2F;kde&#x2F;images&#x2F;share.png" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="640" />
    <meta property="og:type" content="article" />

    <meta property="og:description" content="A useful statistical tool that sounds scarier than it is." />
    <meta property="description" content="A useful statistical tool that sounds scarier than it is." />
    <meta property="twitter:creator" content="mathisonian" />
    <link
      rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css"
    />

    <link rel="stylesheet" href="static/idyll_styles.css" />
  </head>
  <body>
    <div id="idyll-mount"><div data-reactroot=""><div class="idyll-root"><div class=" idyll-text-container"></div><div style="position:fixed" class="fixed"><div style="width:100%"></div></div><div class=" idyll-text-container"><div class=" idyll-text-container"><div id="idyll-scroll-0" style="position:relative"><div class="idyll-scroll-graphic" style="height:100vh;position:absolute;top:0;left:0;bottom:auto;width:100%;transform:translate3d(0, 0, 0);z-index:-1"><div style="width:0;position:absolute;right:1rem;top:50%;transform:translateY(-50%)"></div></div><div class="idyll-scroll-text"><div class="idyll-scroll-step header" style="margin:10vh 0 60vh 0"><div class="article-header"><h1 class="hed">Kernel Density Estimation</h1><div class="byline">By: <a href="https://twitter.com/mathisonian">Matthew Conlen</a></div></div></div><div class="idyll-scroll-step " style="margin:10vh 0 60vh 0"><p>
    Kernel density estimation is a really useful statistical tool
    with an intimidating name.
    Often shortened to <strong>KDE</strong>, it’s a technique
    that let’s you create a smooth curve given a set of data.</p><p>This can be useful if you want to visualize just the
    “shape” of some data, as a kind of continuous replacement for the discrete histogram.
    It can also be used to generate points that
    <em>look like they came from a certain dataset</em> - this behavior can power simple
    simulations, where simulated objects are modeled off of real data.</p><p>I hope this article provides some intuition for how KDE works.
  </p></div><div class="idyll-scroll-step " style="margin:10vh 0 60vh 0"><p>
    To understand how KDE is used in practice, lets start with some points. The white circles on
    your screen were sampled from some unknown distribution.</p><p>As more points build up, their silhouette will roughly correspond to that distribution, however
    we have no way of knowing its true value.
  </p></div><div class="idyll-scroll-step " style="margin:10vh 0 60vh 0"><p>
    The <span style="color:#090C9B;text-decoration:underline">blue line</span> shows an estimate of the underlying distribution, this is what KDE produces.</p><p>The KDE algorithm takes a parameter, <em>bandwidth</em>, that affects how “smooth” the resulting
    curve is. Use the control below to modify bandwidth, and notice how the estimate changes.</p><p>Bandwidth: <span class="idyll-dynamic">0.05</span></p></div><div class="idyll-scroll-step " style="margin:10vh 0 60vh 0"><p>
    The KDE is calculated by weighting the distances of all the data points we’ve seen
    for each location on the <span style="color:#090C9B;text-decoration:underline">blue line</span>. If we’ve seen more points nearby, the estimate is
    higher, indicating that probability of seeing a point at that location.</p><p>Move your mouse over the graphic to see how the data points contribute to the estimation —
    the “brighter” a selection is, the more likely that location is.
    The <span style="color:#B02E0C;text-decoration:underline">red curve</span> indicates how the point distances are weighted, and is called the <em>kernel function</em>. The points are colored according to this function.</p><p><em>Click to lock the kernel function to a particular location.</em>
  </p></div><div class="idyll-scroll-step " style="margin:10vh 0 60vh 0"><p>
    Changing the bandwidth changes the shape of the kernel: a lower bandwidth means only points very close to the current position are given any weight, which leads to the <span style="color:#090C9B;text-decoration:underline">estimate</span> looking squiggly; a higher bandwidth means a shallow kernel where distant points can contribute.</p><p>Bandwidth: <span class="idyll-dynamic">0.05</span></p><p>Next we’ll see how different kernel functions affect the estimate.
  </p></div><div class="idyll-scroll-step " style="margin:10vh 0 60vh 0"><p>
    The concept of weighting the distances of our observations from a particular point, <span style="display:inline-block"><span> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span> </span></span>,
    can be expressed mathematically as follows:</p><span style="display:block"><span> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>f</mi></mrow><mo>^</mo></mover><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>o</mi><mi>b</mi><mi>s</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow><mrow></mrow></munderover><mrow><mi>K</mi><mo>(</mo><mfrac><mrow><mi>x</mi><mo>−</mo><mi>o</mi><mi>b</mi><mi>s</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow><mrow><mi>b</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mrow></mfrac><mo>)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{f}(x) =  \sum_{observations}^{}{K(\frac{x - observation}{bandwidth})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.673553em;vertical-align:-1.302113em;"></span><span class="base"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.08332999999999999em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3500050000000001em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="mord mathit mtight">b</span><span class="mord mathit mtight">s</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">a</span><span class="mord mathit mtight">t</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight">o</span><span class="mord mathit mtight">n</span><span class="mord mathit mtight">s</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">b</span><span class="mord mathit">a</span><span class="mord mathit">n</span><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord mathit">i</span><span class="mord mathit">d</span><span class="mord mathit">t</span><span class="mord mathit">h</span></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.2em;"><svg width='400em' height='0.2em' viewBox='0 0 400000 200' preserveAspectRatio='xMinYMin slice'><path d='M0 80H400000 v40H0z M0 80H400000 v40H0z'/></svg></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">o</span><span class="mord mathit">b</span><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></span> </span></span><p>The variable <span style="display:inline-block"><span> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span> </span></span> represents the kernel function. Using different
    kernel functions will produce different estimates. Use the dropdown to see how changing the kernel affects the estimate.</p><p>Kernel:
    <select options="[object Object],[object Object],[object Object],[object Object]"><option selected="" value="epanechnikov">Epanechnikov</option><option value="normal">Normal</option><option value="uniform">Uniform</option><option value="triangular">Triangular</option></select><br/>
    Bandwidth: <span class="idyll-dynamic">0.05</span><br/>
    Amplitude: <span class="idyll-dynamic">3.00</span></p></div><div class="idyll-scroll-step " style="margin:10vh 0 60vh 0"><p>That’s all for now, thanks for reading! I’ll be making more of these
    quick explainer posts, so if you have an idea for a concept you’d like
    to see, <a url="https://twitter.com/mathisonian" href="https://twitter.com/mathisonian">reach out on twitter</a>.</p><p>Here are a few useful links:</p><ul><li><p><a href="https://idyll-lang.org/">Idyll: the software used to write this post</a>.</p></li><li><p><a href="https://github.com/mathisonian/kde/">The source code for this post</a>.</p></li><li><p><a href="https://en.wikipedia.org/wiki/Kernel_density_estimation">Learn more about kernel density estimation</a>.</p></li><li><p><a href="https://bl.ocks.org/mbostock/4341954">A D3 + JavaScript KDE reference</a>.</p></li></ul></div></div></div></div></div></div></div></div>
    <script src="static/idyll_index.js"></script>
  </body>
</html>
